$(function(){function n(){$("#usersTable").DataTable();$("form.employee").find(":text, input[type='tel'], input[type='email'], select").val("");t()}function t(){$.validator.addMethod("alphabet",function(n,t){return this.optional(t)||/^[a-zA-Z ]+$/.test(n)});$.validator.addMethod("phone",function(n,t){return this.optional(t)||/^(\+0?1\s)?\(?\d{3}\)?([\s-])?\d{3}([\s-])?\d{4}$/.test(n)});$("form.employee").validate({rules:{Email:{required:!0,email:!0},FirstName:{required:!0,alphabet:!0,maxlength:25},MiddleName:{alphabet:!0,maxlength:25},LastName:{required:!0,alphabet:!0,maxlength:25},PhoneNumber:{phone:!0}},messages:{Email:{required:"please enter email address.",date:"please enter a valid email address."},FirstName:{required:"please enter first name.",alphabet:"please enter a valid first name.",maxlength:"First name can not be longer than 25 characters."},MiddleName:{alphabet:"please enter a valid middle name.",maxlength:"Middle name can not be longer than 25 characters."},LastName:{required:"please enter last name.",alphabet:"please enter a valid last name.",maxlength:"Last name can not be longer than 25 characters."},PhoneNumber:{phone:"Please provide a valid phone number."}}})}n();$(document).on("click","button[type=submit]",function(){$("button[type=submit]",$(this).parents("form")).removeAttr("clicked");$(this).attr("clicked","true")});$(document).on("submit","form.employee",function(t){t.preventDefault();var i=$("button[type=submit][clicked=true]").attr("name");$("#wait").modal("show");i==="save"?$.ajax({type:"post",url:"/Admin/SaveUser",data:$(this).serialize(),success:function(t){$("#EmployeesWidget").html(t);$("#wait").modal("hide");$(".savenotify").notify("Employee has been added/updated successfully!","success");n()},error:function(n){$("#wait").modal("hide");n.status===403?$(".savenotify").notify("There is an employee registered with the same first, middle and lastname.","error"):$(".savenotify").notify("Error occurred while adding/updating employee. Please try again later.","error")}}):$.ajax({type:"post",url:"/Admin/ResetUserPassword",data:$("form.employee").serialize(),success:function(){$("#wait").modal("hide");$(".savenotify").notify("Employee password has been reset successfully!","success");n()},error:function(){$("#wait").modal("hide");$(".savenotify").notify("Error occurred while resetting employee password. Please try again later.","error")}})});$(document).on("click",".delete-user",function(n){n.preventDefault();$("#userId").html($(this).data("user"));$("#confirmModal").modal("show")});$(document).on("click",".edit-user",function(n){n.preventDefault();$.get("/Admin/EditUser/?userId="+$(this).data("user"),function(n){$("#EmployeeWidget").html(n);t()})});$(document).on("click","#confirmButton",function(t){t.preventDefault();$("#confirmModal").modal("hide");$("#wait").modal("show");$.ajax({type:"post",url:"/Admin/DeleteUser",data:{userId:$("#userId").html(),__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()},success:function(t){$("#EmployeesWidget").html(t);$("#wait").modal("hide");$(".notify").notify("Employee has been removed successfully!","success");n()},error:function(n){$("#wait").modal("hide");$(".notify").notify(n.status==400?"System was unable to find the employee to remove.":"Error occurred while removing the employee. Please try again later.","error")}})})});